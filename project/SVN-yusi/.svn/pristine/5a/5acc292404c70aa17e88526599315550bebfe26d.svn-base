package mybatisPro.mybatisService;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

import ekuter.mvc.constants.Constants;
import ekuter.mvc.exception.BusinessException;
import mybatisPro.dataBase.SqlSessionHander;
import mybatisPro.myBatisDao.StationParam;
import mybatisPro.mybatisService.impl.StationParamService;

/**
 * 平均降雨量测站系业务层实现类
 * @author si.yu
 * @date 2017/07/26
 * @version 1.0
 * */
@Service
public class StationParamServiceImpl implements StationParamService{
	
	private static final Logger logger=LoggerFactory.getLogger(StationParamServiceImpl.class);
	
	/**
	 * 根据测站ID查询该站的系数
	 * @param sta_id
	 * @return
	 * */
	@Override
	public Float getStationParamByStaId(Long sta_id) {
		try {
			return SqlSessionHander.SqlExecute(sqlsession->{
				StationParam stationParamMapper = sqlsession.getMapper(StationParam.class);
				Float sta_param = stationParamMapper.getStationParamByStaId(sta_id);
				return sta_param;
			});
		} catch (Exception e) {
			logger.info(e.getMessage());
			throw new BusinessException(Constants.EXCEPTION_MAP.get("STATIONPARAM"));
		}
	}

}
