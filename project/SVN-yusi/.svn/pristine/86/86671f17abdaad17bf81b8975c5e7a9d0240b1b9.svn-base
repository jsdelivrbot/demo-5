<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mybatisPro.myBatisDao.DataSupplementMapper">
	<cache type="mybatisPro.mybatisRedis.MybatisRedisCache" />
	
	<!-- 查询雨量测站数据 -->
	<select id="getRainfallStationData" resultType="map">
		SELECT
		    ST_BS_STBPRP_B.station_name
		    , ST_RP_PPTN_R.*
		FROM
		    rwdb.ST_RP_PPTN_R
		    INNER JOIN rwdb.ST_BS_STBPRP_B 
		        ON (ST_RP_PPTN_R.sta_id = ST_BS_STBPRP_B.id)
		WHERE ST_BS_STBPRP_B.id = #{staId}
		AND ST_RP_PPTN_R.time 
		BETWEEN #{beginTime} AND #{endTime};

	</select>
	
	<!-- 查询水库水位站测站数据 -->
	<select id="getResvoirStationData" resultType="map">
		SELECT
			ST_BS_STBPRP_B.station_name,
			ST_WZ_RSVR_R.*
		FROM
			rwdb.ST_WZ_RSVR_R
		INNER JOIN rwdb.ST_BS_STBPRP_B ON (
			ST_WZ_RSVR_R.sta_id = ST_BS_STBPRP_B.id
		)
		WHERE
			ST_BS_STBPRP_B.id = #{staId}
		AND ST_WZ_RSVR_R.time 
		BETWEEN #{beginTime} AND #{endTime};
	</select>
	
	<!-- 查询河道水位站测站数据 -->
	<select id="getRiverStationData" resultType="map">
		SELECT
			ST_BS_STBPRP_B.station_name,
			ST_WZ_RIVER_R.*
		FROM
			rwdb.ST_WZ_RIVER_R
		INNER JOIN rwdb.ST_BS_STBPRP_B ON (
			ST_WZ_RIVER_R.sta_id = ST_BS_STBPRP_B.id
		)
		WHERE
			ST_BS_STBPRP_B.id = #{staId}
		AND ST_WZ_RIVER_R.time
		BETWEEN #{beginTime} AND #{endTime};
	</select>
	
</mapper>