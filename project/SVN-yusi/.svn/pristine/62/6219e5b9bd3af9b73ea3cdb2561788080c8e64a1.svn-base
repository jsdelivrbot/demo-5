<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mybatisPro.myBatisDao.ManMadeStationMapper">
	<cache type="mybatisPro.mybatisRedis.MybatisRedisCache" />
	
	<!-- 人工上报数据(雨量数据插入) -->
	<insert id="insertIntoRainFallData" parameterType="mybatisPro.mybatisEntity.RainfallEntity"
	keyProperty="sta_id" useGeneratedKeys="true">
	
		INSERT INTO ST_RP_PPTN_R
			(sta_id,time,time_rainfall,time_interval,createtime)
		VALUES(
			#{sta_id},#{time},#{time_rainfall},#{time_interval},#{createtime}
		)
	</insert>

	<!-- 工上报数据（水库水位数据插入） -->
	<insert id="insertResvoirData" parameterType="mybatisPro.mybatisEntity.ReservoirWaterLevelEntity"
	keyProperty="sta_id" useGeneratedKeys="true">
		INSERT INTO ST_WZ_RSVR_R
			(sta_id,time,waterLevel,storageCapacity,createtime)
		VALUES(
			#{sta_id},#{time},#{waterLevel},#{storageCapacity},#{createtime}
		)
	</insert>
	
	
	<!-- 工上报数据（河道水位数据插入） -->
	<insert id="insertRiverData" parameterType="mybatisPro.mybatisEntity.RiverWaterLevelEntity"
	keyProperty="sta_id" useGeneratedKeys="true">
		INSERT INTO ST_WZ_RIVER_R
			(sta_id,time,waterLevel,rateOfFlow,createtime)
		VALUES(
			#{sta_id},#{time},#{waterLevel},#{rateOfFlow},#{createtime}
		)
	</insert>
	
	<!-- 根据数据ID修改雨量数据 -->
	<update id="updateRainFallData" parameterType="mybatisPro.mybatisEntity.RainfallEntity">
		UPDATE ST_RP_PPTN_R
		<set>
			<if test="time_rainfall!=null">
				time_rainfall=#{time_rainfall},
			</if>
			<if test="time!=null">
				time=#{time},
			</if>
			<if test="time_interval!=null">
				time_interval=#{time_interval},
			</if>
			<if test="createtime!=null">
				createtime=#{createtime}
			</if>
			where id=#{id}
		</set>
	</update>
	
	
	<!-- 根据数据ID修改水库水位数据 -->
	<update id="updateResvoirData" parameterType="mybatisPro.mybatisEntity.ReservoirWaterLevelEntity">
		UPDATE ST_WZ_RSVR_R
		<set>
			<if test="time!=null">
				time=#{time},
			</if>
			<if test="waterLevel!=null">
				waterLevel=#{waterLevel},
			</if>
			<if test="storageCapacity!=null">
				storageCapacity=#{storageCapacity},
			</if>
			<if test="createtime!=null">
				createtime=#{createtime}
			</if>
			where id=#{id}
		</set>
	</update>
	
	
	<!-- 根据数据ID修改河道水位数据 -->
	<update id="updateRiverData" parameterType="mybatisPro.mybatisEntity.RiverWaterLevelEntity">
		UPDATE ST_WZ_RIVER_R
		<set>
			<if test="time!=null">
				time=#{time},
			</if>
			<if test="waterLevel!=null">
				waterLevel=#{waterLevel},
			</if>
			<if test="rateOfFlow!=null">
				rateOfFlow=#{rateOfFlow},
			</if>
			<if test="createtime!=null">
				createtime=#{createtime}
			</if>
			where id=#{id}
		</set>
	</update>
	
	<!-- 根据上报数据的日期查询是否已有上报装填 -->
	<select id="findReportStatus" resultType="mybatisPro.mybatisEntity.ReportStatusEntity">
		SELECT * FROM ManMadeReportStatus WHERE reportTime = #{reportTime};
	</select>
	
	<!-- 插入上报状态数据 -->
	<insert id="insertReportStatus" parameterType="mybatisPro.mybatisEntity.ReportStatusEntity"
	keyProperty="id" useGeneratedKeys="true">
		INSERT INTO ManMadeReportStatus
			(reportTime,reportStatus,modify_time)
		VALUES(
			#{reportTime},#{reportStatus},#{modify_time}
			);
	</insert>
	
	<!-- 查询时间段内的所有上报数据状态 -->
	<select id="getListOfReportStatusData" resultType="mybatisPro.mybatisEntity.ReportStatusEntity">
		SELECT * FROM ManMadeReportStatus 
		WHERE modify_time 
		BETWEEN #{beginTime} AND #{endTime};
	</select>
</mapper>